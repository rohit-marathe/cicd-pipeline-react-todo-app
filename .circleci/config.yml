version: 2.1

workflows: cicd pipeline
    build-deploy:
    jobs:
        - build
        - deploy:
            requires:
            - build
            filters:
            branches:
                only: main

jobs:
    build:
    docker:
        - image: todo:latest
          auth:
            username: rohitmarathe
            password: $DOCKERHUB_PASSWORD  
    ... 
    deploy:
    docker: 
        - image: todo:latest 
          auth:
            username: rohitmarathe
            password: $DOCKERHUB_PASSWORD
    steps:
        - run: 
            name: Install awscli
            command: sudo pip install awscli
        - run:
            name: Deploy to S3
            command: aws s3 sync . s3://myreact-cicd